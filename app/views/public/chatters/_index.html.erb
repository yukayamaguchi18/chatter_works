<% if chatters.blank? %>
  <p>データはありません</p>
<% else %>
  <% chatters.each_with_index.reverse_each do |chatter, i| %>
    <div class="py-2 px-4">
      <%# ↓リポストを取得しない投稿一覧ページ（お気に入り一覧など）でも
      同じ部分テンプレートを利用しているため、この判定を入れている %>
      <% if chatter.has_attribute?(:rechatter_user_id) %>
        <% if chatter.rechatter_user_id.present? %>
          <div class="row ml-1 mb-1">
            <i class="fa-solid fa-bullhorn text-info"></i>
            <span class="text-muted">
              Rechattered by
              <%= link_to chatter.rechatter_user_name, user_path(chatter.rechatter_user_id), class: "text-muted" %>
            </span>
          </div>
        <% end %>
      <% end %>
      <% if chatter.replying.exists? %>
        <div class="ml-1 mb-1">
          <%= link_to chatter_path(chatter.replied_chatter(chatter)), class: "text-decoration-none" do %>
            <i class="fa-solid fa-reply text-muted"></i>
            <span class="text-muted">Reply to <%= chatter.replied_chatter(chatter).user.name %></span>
          <% end %>
        </div>
      <% end %>
      <div class="row">
        <div class="col-2">
          <%= link_to user_path(chatter.user) do %>
            <%= image_tag chatter.user.get_profile_image(50, 50) %>
          <% end %>
          <% if chatter.user == current_user %>
            <%= link_to chatter_path(chatter), method: :delete, remote: true, class: "btn btn-sm btn-danger", data: { confirm: "削除しますか？" } do %>
              <i class="fa-solid fa-trash-can"></i>
            <% end %>
          <% end %>
        </div>
        <div class="col-9">
          <p>
            <%= chatter.user.name %>
            <%= chatter.created_at.strftime('%Y/%m/%d %H:%M') %>
          </p>
          <p><%= raw Rinku.auto_link(h(safe_join(chatter.body.split("\n"),tag(:br)))) %></p>
          <div class="row">
            <div class="text-muted" style="cursor: pointer;" data-toggle="modal" data-target="#reply-modal_<%= chatter.id %>">
              <i class="fa-solid fa-reply"></i><%= chatter.reply_to_chatters.count %>
            </div>
            <div class="rechatter-btn_<%= chatter.id %>">
              <%= render 'public/rechatters/rechatter-btn', chatter: chatter %>
            </div>
            <div class="chatter-favorite-btn_<%= chatter.id %>">
              <%= render 'public/chatter_favorites/favorite-btn', chatter: chatter %>
            </div>
          </div>
        </div>
      </div>
    <hr color="#6c757d">
    </div>

      <!--reply modal-->
      <%= render 'public/replies/modal', reply_to: chatter %>
  <% end %>
<% end %>