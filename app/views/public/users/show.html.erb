<div class="container p-3">
  <div class="row d-flex justify-content-center">
    <div class="col-3 d-flex justify-content-center">
      <%= image_tag @user.get_profile_image(150, 150), style: "object-fit: contain; width: 150px; height: 150px;" %>
    </div>
    <div class="col-9">
      <div class="d-flex justify-content-around">
        <h3><%= @user.name %></h3>
        <% unless @user == current_user %>
          <div class="follow-btn_<%= @user.id %>">
            <%= render "public/relationships/follow", user: @user %>
          </div>
        <% end %>
      </div>
      <% if @user.is_public == true %>
        <p class="text-muted">
          public <i class="fa-solid fa-lock-open"></i>
        </p>
      <% else %>
        <p class="text-muted">
          private <i class="fa-solid fa-lock"></i>
        </p>
      <% end %>

      <div class="d-flex justify-content-between">
        <div>
          <%= link_to followings_user_relationships_path(@user) do %>
            <span class="followings-count_<%= @user.id %>">
              <%= render "public/relationships/followings-count", user: @user %>
            </span>
          <% end %>
          <%= link_to followers_user_relationships_path(@user) do %>
            <span class="followers-count_<%= @user.id %>">
              <%= render "public/relationships/followers-count", user: @user %>
            </span>
          <% end %>
        </div>
        <% if @user == current_user %>
          <% unless @user.guest_user? %>
            <%= link_to "Edit" ,edit_user_path(@user), class: "btn btn-primary ml-3" %>
          <% end %>
        <% end %>
      </div>

    </div>
  </div>

  <div class="col-12 mx-auto my-3">
    <p><%= raw Rinku.auto_link(h(safe_join(@user.introduction.split("\n"),tag(:br)))) %></p>
  </div>

  <div class="col-12">
    <% unless @user.is_public == true || current_user.following?(@user) %>
      <p>このユーザーの情報は非公開です</p>
    <% else %>
      <!-- タブ -->
      <ul class="nav nav-tabs nav-fill">
        <li class="nav-item">
          <a href="#chatters" class="nav-link active" data-toggle="tab">Chatters</a>
        </li>
        <li class="nav-item">
          <a href="#works" class="nav-link" data-toggle="tab">Works</a>
        </li>
        <li class="nav-item">
          <a href="#chatter-favorites" class="nav-link" data-toggle="tab">Chatter Favorites</a>
        </li>
        <li class="nav-item">
          <a href="#work-favorites" class="nav-link" data-toggle="tab">Works Favorites</a>
        </li>
      </ul>
      <!-- タブの中身 -->
      <div class="tab-content">
        <div id="chatters" class="tab-pane active">
          <%= render 'public/chatters/index', chatters: @chatters %>
        </div>
        <div id="works" class="tab-pane">
          <%= render 'public/works/index', works: @user.works %>
        </div>
        <div id="chatter-favorites" class="tab-pane">
          <%= render 'public/chatter_favorites/index', chatter_favorites: @user.chatter_favorites %>
        </div>
        <div id="work-favorites" class="tab-pane">
          <%= render 'public/work_favorites/index', work_favorites: @user.work_favorites %>
        </div>
      </div>
    <% end %>
  </div>

</div>